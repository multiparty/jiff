<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Home - JIFF Library Documentation</title>
    
    
    
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/multiparty/jiff" target="_blank" class="menu-item" id="github_link" >Github Repo</a></h2><h2><a href="./intro.html" target="_self" class="menu-item" id="github_link" >Tutorial</a></h2><h2><a href="./contributing.html" target="_self" class="menu-item" id="github_link" >Contributing to JIFF</a></h2><h3>Namespaces</h3><ul><li><a href="jiff.html">jiff</a><ul class='methods'><li data-type='method'><a href="jiff.html#.dependencies">dependencies</a></li><li data-type='method'><a href="jiff.html#.make_jiff">make_jiff</a></li></ul></li><li><a href="jiff.sharing_schemes.html">sharing_schemes</a><ul class='methods'><li data-type='method'><a href="jiff.sharing_schemes.html#.shamir_reconstruct">shamir_reconstruct</a></li><li data-type='method'><a href="jiff.sharing_schemes.html#.shamir_share">shamir_share</a></li></ul></li><li><a href="jiff.utils.html">utils</a><ul class='methods'><li data-type='method'><a href="jiff.utils.html#.decrypt_and_sign">decrypt_and_sign</a></li><li data-type='method'><a href="jiff.utils.html#.encrypt_and_sign">encrypt_and_sign</a></li><li data-type='method'><a href="jiff.utils.html#.is_prime">is_prime</a></li></ul></li><li><a href="jiff-instance.html">jiff-instance</a><ul class='methods'><li data-type='method'><a href="jiff-instance.html#apply_extension">apply_extension</a></li><li data-type='method'><a href="jiff-instance.html#can_apply_extension">can_apply_extension</a></li><li data-type='method'><a href="jiff-instance.html#connect">connect</a></li><li data-type='method'><a href="jiff-instance.html#disconnect">disconnect</a></li><li data-type='method'><a href="jiff-instance.html#emit">emit</a></li><li data-type='method'><a href="jiff-instance.html#execute_array_hooks">execute_array_hooks</a></li><li data-type='method'><a href="jiff-instance.html#has_extension">has_extension</a></li><li data-type='method'><a href="jiff-instance.html#isReady">isReady</a></li><li data-type='method'><a href="jiff-instance.html#listen">listen</a></li><li data-type='method'><a href="jiff-instance.html#open">open</a></li><li data-type='method'><a href="jiff-instance.html#open_2D_array">open_2D_array</a></li><li data-type='method'><a href="jiff-instance.html#open_array">open_array</a></li><li data-type='method'><a href="jiff-instance.html#receive_open">receive_open</a></li><li data-type='method'><a href="jiff-instance.html#secret_share">secret_share</a></li><li data-type='method'><a href="jiff-instance.html#server_generate_and_share">server_generate_and_share</a></li><li data-type='method'><a href="jiff-instance.html#share">share</a></li><li data-type='method'><a href="jiff-instance.html#share_2D_array">share_2D_array</a></li><li data-type='method'><a href="jiff-instance.html#share_array">share_array</a></li><li data-type='method'><a href="jiff-instance.html#triplet">triplet</a></li><li data-type='method'><a href="jiff-instance.html#%257BPromise%257Dsodium">{Promise} sodium</a></li></ul></li><li><a href="jiff-instance.helpers.html">helpers</a><ul class='methods'><li data-type='method'><a href="jiff-instance.helpers.html#array_equals">array_equals</a></li><li data-type='method'><a href="jiff-instance.helpers.html#bLog">bLog</a></li><li data-type='method'><a href="jiff-instance.helpers.html#extended_gcd">extended_gcd</a></li><li data-type='method'><a href="jiff-instance.helpers.html#mod">mod</a></li><li data-type='method'><a href="jiff-instance.helpers.html#pow_mod">pow_mod</a></li><li data-type='method'><a href="jiff-instance.helpers.html#random">random</a></li><li data-type='method'><a href="jiff-instance.helpers.html#Zp_equals">Zp_equals</a></li></ul></li><li><a href="jiff-instance.protocols.html">protocols</a><ul class='methods'><li data-type='method'><a href="jiff-instance.protocols.html#bit_composition">bit_composition</a></li><li data-type='method'><a href="jiff-instance.protocols.html#clt_bits">clt_bits</a></li><li data-type='method'><a href="jiff-instance.protocols.html#generate_and_share_random">generate_and_share_random</a></li><li data-type='method'><a href="jiff-instance.protocols.html#generate_and_share_zero">generate_and_share_zero</a></li><li data-type='method'><a href="jiff-instance.protocols.html#generate_random_bit">generate_random_bit</a></li></ul></li><li><a href="SecretShare.html">SecretShare</a><ul class='methods'><li data-type='method'><a href="SecretShare.html#add">add</a></li><li data-type='method'><a href="SecretShare.html#cadd">cadd</a></li><li data-type='method'><a href="SecretShare.html#cdiv">cdiv</a></li><li data-type='method'><a href="SecretShare.html#cdivfac">cdivfac</a></li><li data-type='method'><a href="SecretShare.html#ceq">ceq</a></li><li data-type='method'><a href="SecretShare.html#cgt">cgt</a></li><li data-type='method'><a href="SecretShare.html#cgteqn">cgteqn</a></li><li data-type='method'><a href="SecretShare.html#change_threshold">change_threshold</a></li><li data-type='method'><a href="SecretShare.html#clt">clt</a></li><li data-type='method'><a href="SecretShare.html#clteq">clteq</a></li><li data-type='method'><a href="SecretShare.html#cmult">cmult</a></li><li data-type='method'><a href="SecretShare.html#cneq">cneq</a></li><li data-type='method'><a href="SecretShare.html#cor_bit">cor_bit</a></li><li data-type='method'><a href="SecretShare.html#csub">csub</a></li><li data-type='method'><a href="SecretShare.html#cxor_bit">cxor_bit</a></li><li data-type='method'><a href="SecretShare.html#div">div</a></li><li data-type='method'><a href="SecretShare.html#eq">eq</a></li><li data-type='method'><a href="SecretShare.html#error">error</a></li><li data-type='method'><a href="SecretShare.html#gt">gt</a></li><li data-type='method'><a href="SecretShare.html#gteq">gteq</a></li><li data-type='method'><a href="SecretShare.html#if_else">if_else</a></li><li data-type='method'><a href="SecretShare.html#logLEAK">logLEAK</a></li><li data-type='method'><a href="SecretShare.html#lt">lt</a></li><li data-type='method'><a href="SecretShare.html#lt_halfprime">lt_halfprime</a></li><li data-type='method'><a href="SecretShare.html#lteq">lteq</a></li><li data-type='method'><a href="SecretShare.html#mult">mult</a></li><li data-type='method'><a href="SecretShare.html#neq">neq</a></li><li data-type='method'><a href="SecretShare.html#not">not</a></li><li data-type='method'><a href="SecretShare.html#open">open</a></li><li data-type='method'><a href="SecretShare.html#or_bit">or_bit</a></li><li data-type='method'><a href="SecretShare.html#pick_promise">pick_promise</a></li><li data-type='method'><a href="SecretShare.html#receive_share">receive_share</a></li><li data-type='method'><a href="SecretShare.html#refresh">refresh</a></li><li data-type='method'><a href="SecretShare.html#sadd">sadd</a></li><li data-type='method'><a href="SecretShare.html#sdiv">sdiv</a></li><li data-type='method'><a href="SecretShare.html#seq">seq</a></li><li data-type='method'><a href="SecretShare.html#sgt">sgt</a></li><li data-type='method'><a href="SecretShare.html#sgteq">sgteq</a></li><li data-type='method'><a href="SecretShare.html#slt">slt</a></li><li data-type='method'><a href="SecretShare.html#slteq">slteq</a></li><li data-type='method'><a href="SecretShare.html#smod">smod</a></li><li data-type='method'><a href="SecretShare.html#smult">smult</a></li><li data-type='method'><a href="SecretShare.html#smult_bgw">smult_bgw</a></li><li data-type='method'><a href="SecretShare.html#sneq">sneq</a></li><li data-type='method'><a href="SecretShare.html#sor_bit">sor_bit</a></li><li data-type='method'><a href="SecretShare.html#ssub">ssub</a></li><li data-type='method'><a href="SecretShare.html#sub">sub</a></li><li data-type='method'><a href="SecretShare.html#sxor_bit">sxor_bit</a></li><li data-type='method'><a href="SecretShare.html#toString">toString</a></li><li data-type='method'><a href="SecretShare.html#valueOf">valueOf</a></li><li data-type='method'><a href="SecretShare.html#xor_bit">xor_bit</a></li></ul></li></ul>
</nav>

<div id="main">
    

    



    


    <section class="package">
        <h3> </h3>		
    </section>









    



    <section class="readme">
        <article><h1>Why Use JIFF?</h1><p>My group of friends and I are planning a vacation together. We want to see if we can afford a certain trip (let's say total it would cost $5000) but none of us want to reveal how much we are willing to pay (maybe not the greatest friends...). Hey, I have an idea! Let's use JIFF to compute our total budget without sharing how much any individual is willing to pay. Then we can see if we can afford the trip and no one has to reveal their personal budget.</p>
<p>Here's what we'll do:</p>
<ol>
<li>Install JIFF</li>
<li>Set up a server to help us coordinate and communicate</li>
<li>Each of us will use JIFF to (securely) our personal budget. This won't reveal anyone's information, but will allow us to work together to compute what we want to know (if we can afford our $5000 vacation).</li>
<li>Together, we'll compute the sum of our personal budgets, and compare this to the $5000 expense.</li>
<li>At the end, we'll only reveal if our total budget is greater or equal to $5000, the total budet can stay a secret!</li>
<li>Go on vacation!! (hopefully)</li>
</ol>
<p>We'll walk through the process step-by-step, and at the end we'll have two working files: one to run the server, and one for each freind participate with.</p>
<h1>Installing JIFF</h1><p>First, we'll install JIFF via npm:</p>
<pre class="prettyprint source lang-sh"><code>npm install jiff-mpc</code></pre><h1>Using JIFF</h1><p>Now, we need to set up a server to pass messages between each other.</p>
<h2>Setting up the Server</h2><p>The server only needs to contain one file, server.js. We simply make a jiff server instance, and listen on an open port:</p>
<pre class="prettyprint source lang-javascript"><code>require('../../lib/jiff-server').make_jiff(http, { logs:true });

// Serve static files.
http.listen(8080, function () {
  console.log('listening on *:8080');
});</code></pre><h2>Defining a JIFF Client</h2><p>First, each friend makes a jiff client instance to participate in the computation. We'll call our computation 'our_computation':</p>
<pre class="prettyprint source lang-javascript"><code>jiff = require('../../lib/jiff-client');
var my_jiff_instance = jiff.make_jiff('localhost:8080', 'our_computation');</code></pre><p>Here we define the jiff instance, tell it to connect to the server running on localhost, and specify which computation we want to be part of.</p>
<h2>Computation</h2><p>The JIFF instance lets us do all sorts of fun things, like (securely) sharing our input with all the parties in our computation. This is done with the jiff.share() method:</p>
<pre class="prettyprint source lang-javascript"><code>var my_budget = 1000;
var shares = my_jiff_instance.share(my_budget);
</code></pre><p>the variable <code>shares</code> contains one secret-share of the value each friend sent (using the same code as us), as well as a secret-share of our budget.</p>
<p>Next let's sum everybody's budget together. For now, we'll assume there are only two of us planning the vacation (we can invite more people later!)</p>
<pre class="prettyprint source lang-javascript"><code>var total_budget = shares[1].add(shares[2]);
</code></pre><p>The <code>add()</code> is a function on the secret-share object, which will return another secret share of the sum. Here we're adding two secret shares together, but we could also use it to add a public constant to a share.</p>
<p>The secret-share object has lots of useful functions defined for arithemtic operations(lke <code>add()</code>) as well as for comparisons.
We'll use a comparison to check if our total budget meets the cost of the vaction:</p>
<pre class="prettyprint source lang-javascript"><code>var is_enough = sum.gteq(5000);</code></pre><p><code>is_enough</code> is also a secret share, but this time we know the true value will either be a 1 or a 0, depending on the result of the comparison.</p>
<p>Finally, we can reveal the result of our computation by opening the value contained in <code>is_enough</code>:</p>
<pre class="prettyprint source lang-javascript"><code>var result = my_jiff_instance.open(is_enough);</code></pre><p>Because we might be waiting for other people in the computation, <code>result</code> is actually a promise to a value, so we can't immediately print it out. Instead we'll wait for the promise to be resolved before printing anything:</p>
<pre class="prettyprint source lang-javascript"><code>result.then(function (result) {
  if (result) console.log(&quot;We're going on vacation!&quot;);
  else console.log(&quot;We can't afford to go :(&quot;);
});</code></pre><h1>Running the Whole Computation</h1><p>Now that we know how to use the different features of JIFF, let's do some refactoring to make our program a bit more robust.</p>
<p>First we'll take input from the command line for our budget instead of hardcoding it:</p>
<pre class="prettyprint source lang-javascript"><code>var my_budget = parseInt(process.argv[2], 10);</code></pre><p>We should also build an object with the JIFF options and pass that to make_jiff, to make it more readable if we add anything in the future:</p>
<pre class="prettyprint source lang-javascript"><code>var options = {'party_count': 2};</code></pre><p>To make sure the client waits to connect before doing anything, we'll wrap our computation in a function and pass it to the JIFF instance as the <code>onConnect</code> option:</p>
<pre class="prettyprint source lang-javascript"><code>options.onConnect = function(my_jiff_instance) {

  var shares = my_jiff_instance.share(my_budget);

  var total_budget = shares[1].add(shares[2]);
  var result = my_jiff_instance.open(is_enough);

  result.then(function (result) {
    if (result) console.log(&quot;We're going on vacation!&quot;);
    else console.log(&quot;We can't afford to go :( &quot;);

    jiff_instance.disconnect();
  });

};</code></pre><p>Now we can make our JIFF instance and pass it everything it needs in the options parameter:</p>
<pre class="prettyprint source lang-javascript"><code>var my_jiff_instance = jiff.make_jiff('localhost:8080', 'our_computation', options);</code></pre><p>And that's it!
As soon as we connect to the server, our <code>onConnect</code> function will execute and we'll send shares to the other parties (when they're connected as well), run our computation and get the result, then disconnect from the server.</p>
<h2>Complete Files</h2><h3>party.js</h3><pre class="prettyprint source lang-javascript"><code>jiff = require('../../lib/jiff-client');

var my_budget = parseInt(process.argv[2], 10);

var options = {'party_count': 2};
options.onConnect = function(my_jiff_instance) {

  var shares = my_jiff_instance.share(my_budget);

  var total_budget = shares[1].add(shares[2]);
  var result = my_jiff_instance.open(is_enough);

  result.then(function (result) {
    if (result) console.log(&quot;We're going on vacation!&quot;);
    else console.log(&quot;We can't afford to go :( &quot;);

    jiff_instance.disconnect(false, true);
  });

};

var my_jiff_instance = jiff.make_jiff('localhost:8080', 'our_computation', options);
</code></pre><h3>server.js</h3><pre class="prettyprint source lang-javascript"><code>var express = require('express');
var app = express();
var http = require('http').Server(app);

//Serve static files
//Configure App
app.use('/demos', express.static('demos'));
app.use('/lib', express.static('lib'));
app.use('/lib/ext', express.static('lib/ext'));

require('../../lib/jiff-server').make_jiff(http, { logs:true });

// Serve static files.
try {
  http.listen(8080, function () {
    console.log('listening on *:8080');
  });
} catch (err) {
  console.log('ERROR:'+err.message)
}

console.log('To run a node.js based party: node party &lt;input>');</code></pre></article>
    </section>






    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Jul 10 2019 13:12:57 GMT-0400 (Eastern Daylight Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



</body>
</html>
